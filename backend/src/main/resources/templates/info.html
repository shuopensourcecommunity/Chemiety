<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"> <!-- #409EFF -->
    <!-- import axios -->
    <script src="https://unpkg.com/axios/dist/axios.js"></script>
    <!-- import Vue before Element -->
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <!-- import JavaScript -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <title>公告管理</title>
    <style type="text/css">
　　      a { text-decoration: none }
　　      publish { margin: 20px }
　　 </style>
</head>
<body>
<div id="app">
    <el-container>
        <el-header>
            <el-menu :default-active="activeIndex" class="el-menu-demo" mode="horizontal" @select="handleSelect">
                <el-menu-item index="1"><a href="/admin/index">Dashboard</a></el-menu-item>
                <el-menu-item index="2"><a href="/admin/checkPost">帖子管理</a></el-menu-item>
                <el-menu-item index="3"><a href="/admin/info">公告管理</a></el-menu-item>
                <el-menu-item index="4"><a href="/admin/settings">设置</a></el-menu-item>
                <el-menu-item index="5"><a href="/admin/fileUpload">资料上传</a></el-menu-item>

            </el-menu>
        </el-header>
        <el-main>
            <el-card>
                <div slot="header" class="clearfix">
                    <span>新建公告</span>
                </div>
                <div class="text item">
                    <el-input
                            type="textarea"
                            margin-bottom="20px"
                            autosize
                            placeholder="请输入内容"
                            v-model="infoInput">
                    </el-input>
                    <el-button type="primary" @click="createInfo" style="margin: 15px">发布</el-button>
                </div>
            </el-card>
            <div v-for="info in infos" style="padding-top: 30px">
                <el-card>
                    <div slot="header" class="clearfix">
                        <span>{{info.createDate}}</span>
                        <el-button style="float: right; padding: 3px 0" type="text" @click="open">回复</el-button>
                    </div>
                    <div class="text item">
                        {{info.content}}
                    </div>
                </el-card>
            </div>

        </el-main>
    </el-container>
</div>
</body>
<script>
    let app = new Vue({
        el: '#app',
        data () {
            return {
                activeIndex: '3',
                currentTime: '',
                hasClassTable: false,
                infoInput: '',
                infos: []
            }
        },
        created () {
            this.getInfos()
        },
        methods: {
            open3() {
                this.$prompt('请输入邮箱', '提示', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    inputPattern: /[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/,
                    inputErrorMessage: '邮箱格式不正确'
                }).then(({ value }) => {
                    this.$message({
                        type: 'success',
                        message: '你的邮箱是: ' + value
                    });
                }).catch(() => {
                    this.$message({
                        type: 'info',
                        message: '取消输入'
                    });
                });
            },
            getInfos() {
                axios({
                    url: '/getAllInfo',
                    method: 'POST',
                })
                    .then(res => {
                        this.infos = res.data.result
                        console.log(this.info)
                    })
                    .catch(err => {
                        console.log(err)
                    })
            },
            createInfo() {
                axios({
                    url: '/postInfo',
                    method: 'POST',
                    params: {
                        content: this.infoInput
                    }
                })
                    .then(res => {
                        console.log(res)
                    })
                    .catch(err => {
                        console.log(err)
                    })
            }
        }
    })
</script>
</html>